/* le717.github.io - v0.8.0
 * http://le717.github.io
 * Created 2015 Triangle717;
 * Licensed under the The MIT License
 */
!function(a){"use strict";function b(a,b,c,d,e,f,g,h){this.id=a,this.msg=h,this.url=b,this.sha=c,this.date=d,this.repo=e,this.event=g,this["final"]=null,this.repoUrl=f,this.selector="#gh-"+a,this.container="<dl id='gh-"+a+"'></dl>"}function c(a){var b={"01":"January","02":"February","03":"March","04":"April","05":"May","06":"June","07":"July","08":"August","09":"September",10:"October",11:"November",12:"December"},c=a.split("T")[0].split("-"),d=[c[2],c[1],c[0]];return d[1]=b[d[1]]+",",d.join(" ")}function d(a){for(var d=0,e=7;e>d;d+=1){var h=a[d],i=h.id,j="#",k="",l=h.repo.name,m=c(h.created_at).substring(0,h.created_at.length-1),n=f.makeURL(h.repo.url),o="No commit message available.",p=h.type.replace(/event/i,"");if(/comment|fork|watch/gi.test(p))e+=1;else{switch(p){case"Create":var q=h.payload.ref_type;if(/tag/.test(q))continue;k=h.payload.ref,o="Create "+h.payload.ref_type,/branch/.test(q)&&(j=f.makeURL(h.repo.url)+"/tree/"+h.payload.ref);break;case"Release":p=f.makeEventName(h.payload.action,!0),k=h.payload.release.tag_name,j=h.payload.release.html_url,o='"'+h.payload.release.name+'"';break;case"Issues":p=f.makeEventName(h.payload.action,!0),k="#"+h.payload.issue.number,j=h.payload.issue.html_url,o=f.makeEventName(h.payload.action)+' "'+h.payload.issue.title+'"';break;case"Delete":p="Delete",k=h.payload.ref,j=f.makeURL(h.repo.url),o="Delete "+h.payload.ref_type;break;case"Gollum":p="Wiki Edit",k=h.payload.pages[0].sha.substr(0,10),j=h.payload.pages[0].html_url,o=f.capitalFirst(h.payload.pages[0].action),o+=' "'+h.payload.pages[0].title+'"';break;case"PullRequest":p="Pull Request",k="#"+h.payload.number,j=h.payload.pull_request.html_url,o=f.capitalFirst(h.payload.pull_request.state),o+=' "'+h.payload.pull_request.title+'"';break;default:j=f.makeURL(h.payload.commits[0].url),k=h.payload.commits[0].sha.substr(0,10),o=h.payload.commits[0].message}var r=new b(i,j,k,m,l,n,p,o);r.compile(),g.push(r)}}}function e(){var b=a(".gh-events");a(".loading-dots").remove(),g.forEach(function(a){return b.append(a["final"]),!0})}b.prototype.charLimit=80,b.prototype.summarize=function(){this.msg.length>this.charLimit&&(this.msg=this.msg.substr(0,this.charLimit)+"..."),this.msg=this.msg.replace(/\n/,"<br>");var a=this.msg.match(/(?:gh-|#)(\d+)/);if(a){var b="<a target='_blank' href='"+this.repoUrl+"/issues/"+a[1]+"'>"+a[0]+"</a>";this.msg=this.msg.replace(a[0],b)}return!0},b.prototype.compile=function(){var a=["<dl id='gh-",this.id,"'>"];a.push("<dt class='gh-title'>",this.event," "),a.push("<a class='gh-url' target='_blank' href='",this.url,"'>",this.sha,"</a> @ ",this.repo," on ",this.date,"</dt>"),this.summarize(),a.push("<dd><code>",this.msg,"</code></dd>"),a.push("</dl>"),this["final"]=a.join("")};var f={makeURL:function(a){return a.replace(/(?:api\.|repos\/)/gi,"").replace(/commits/gi,"commit")},capitalFirst:function(a){return a.charAt(0).toUpperCase()+a.substr(1)},makeEventName:function(a,b){if(void 0===b&&(b=!1),a=this.capitalFirst(a),b){var c={Closed:"Close",Opened:"Open",Published:"Publish"};void 0!==c[a]&&(a=c[a])}return a}},g=[];a.ajax({dataType:"json",url:"https://api.github.com/users/le717/events/public",success:[d,e],error:function(){var b="Unfortunately that information cannot be loaded right now";return a(".gh-events").html(b),!1}})}(jQuery);