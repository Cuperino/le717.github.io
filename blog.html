---
title: Blog
layout: blogpost
---

<script>
  console.log("Loading blog feed from http://Triangle717.WordPress.com");

  // Store all the blog post objects
  var allBlogPosts = [];

  function BlogPost(postAuthor, postDate, postID, postTitle, postURL, postContent) {
    this.postAuthor       = postAuthor.name;
    this.postAuthorAvatar = postAuthor.avatar_URL.replace(/s=96/, "s=64");
    this.postContainer    = '<div id="{0}"></div>'.format(postID);
    this.postContent      = postContent;
    // FUTURE Convert to datestamp to keep time posted
    this.postDate         = postDate.replace(/(T(.*))$/g, "");
    this.postID           = "#{0}".format(postID);
    this.postTitle        = postTitle;
    this.postURL          = postURL;
  }

  $(function() {
    "use strict";
    /* Create a blog post object
     * Based on example from http://jsfiddle.net/hLWdH/334/
     */
    $.getJSON("http://public-api.wordpress.com/rest/v1/sites/triangle717.wordpress.com/posts/?number=1&callback=?", function(data) {
      console.log("{0} blog posts retrieved".format(data.posts.length));

      data.posts.forEach(function(postInfo) {
        // Create a unique post ID
        var postID  = "post-{0}".format(postInfo.guid.substring(postInfo.guid.indexOf("?p=") + 3, postInfo.guid.length));

        // Create the post object and store it
        var myPost = new BlogPost(postInfo.author, postInfo.date, postID, postInfo.title, postInfo.guid, postInfo.content);
        allBlogPosts.push(myPost);
      });

      // Now that the posts are stored, go through and display them
      showPosts();
      });
    });

    function showPosts() {
      "use strict";
      /* TODO Write me! */
      $.each(allBlogPosts, function(key, value) {

//        console.log(value.postTitle);
//        console.log(value.postAuthorAvatar);
//        console.log(value.postDate);
//        console.log(value.postAuthor);
//        console.log(value.postURL);
//        console.log(value.postID);
//        console.log(value.postContainer);


        // Display post details
        /*$(".post-author-avatar").attr("src", postAuthorAvatar);
        $(".post-title").html(postTitle);
        $(".post-date").html(postDate);
        $(".post-author").html(postAuthor);
        $(".post-url").attr("href", postURL);*/

        // Display post content
        $("body").append(value.postContainer);
        $(value.postID).html(value.postContent)

        // Convert all WordPress emoticons to Emoji
        $(value.postID).wpToEmoji();
    });
  }

    // Remove WordPress emote classes
    /*$(postContainer).find("span").each(function() {
      var $this = $(this);
      $this.removeClass("emoji");
      $this.stripClass("wp-");
      $this.stripClass("emoji-");
      $this.removeAttr("title");*/

    // Remove any WordPress alignment classes
    /*$(postContainer).find("div").each(function() {
      var $this = $(this);
      $this.removeClass("alignnone");
      $this.removeClass("alignleft");
      $this.removeClass("aligncenter");
      $this.removeClass("alignright");
      $this.removeAttr("style");

      // Center any images
      // FIXME: Wrong method!
      if ($this.hasClass("wp-caption")) {
        $this.addClass("text-center");
      }
    });*/

    // Remove image styling
    $("img").removeAttr("style");

    // Remove any WordPress image-related classes
    /*$(postContent).find("img").each(function() {
      var $this = $(this);
      //$(this).removeClass();
      //$this.stripClass("size-");
      $this.removeClass("size-large");
      //$this.addClass("img-shadow");

      // If this is a mobile browser, third the image sizes
      if ($.browser.mobile) {
        $this.width($this.width() / 3);
        $this.height($this.height() / 3);
      }
    });*/
</script>
